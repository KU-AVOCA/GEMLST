# GEMLST (Greenland Ecosystem Monitoring Land Surface Temperature)

[![DOI](https://zenodo.org/badge/924540924.svg)](https://doi.org/10.5281/zenodo.14802659)
[![Hits](https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fgithub.com%2FKU-AVOCA%2FGEMLST&count_bg=%2379C83D&title_bg=%23555555&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=false)](https://hits.seeyoufarm.com)
## Table of Contents
- [Overview](#overview)
- [Requirements](#requirements)
- [GEMLST_MODIS](#gemlst_modis)
  - [Data Sources](#data-sources)
  - [Algorithm Workflow](#algorithm-workflow)
  - [Output Description](#output-description)
- [GEMLST_Landsat](#gemlst_landsat)
  - [Data Sources](#data-sources-1)
  - [Algorithm Workflow](#algorithm-workflow-1)
  - [Output Description](#output-description-1)
- [Comments and Future plans](#comments-and-future-plans)
- [Author](#author)
- [Last Updated](#last-updated)
## Overview
GEMLST generates MODIS and Landsat based land surface temperature products for Greenland by calibration and combining satellite and reanalysis data (2000-present). Two versions are available:
- GEMLST_MODIS: Daily gapless product by calibrating MODIS and ERA5-Land data (1km resolution) for land areas.
- GEMLST_Landsat: Recalibrated Landsat (30m resolution) for both land and ocean areas.

GEMLST_MODIS handles common challenges like cloud cover and data gaps through sophisticated calibration approaches. The datasets are particularly useful for monitoring temperature changes across Greenland's ice sheet and ice-free areas.
An Earth Engine web app is also available to visualize the daily surface temperature dataset for Greenland - [GEMLST-Viewer](https://ku-gem.projects.earthengine.app/view/gemlst-viewer).

GEMLST_Landsat is a high-resolution product that provides calibrated land surface temperature for both land and ocean areas. The dataset is generated by recalibrating Landsat surface temperature data using coefficients derived from GEM automatic weather station (AWS) measurements. The dataset is produced for Kobbefjord, Zackenberg, and Disko Island at the moment. But it's capable of being extended to the entire Greenland. An Earth Engine web app is also available to visualize the surface temperature dataset for Greenland - [GEMLST_Landsat](https://ku-gem.projects.earthengine.app/view/gemlstlandsat).

Note: the calibration coefficients are derived from AWS on land excluding the ice sheet. We plan to expand the calibration to the ice sheet next. 

## Requirements
- Google Earth Engine account
- Access to the following datasets:
  - `MODIS/061/MOD11A1` (Terra LST)
  - `MODIS/061/MYD11A1` (Aqua LST)
  - `ECMWF/ERA5_LAND/HOURLY` (ERA5-Land)
  - `LANDSAT/LC09/C02/T1_L2` (OLI-2 Collection 2 Tier 1)
  - `LANDSAT/LC08/C02/T1_L2` (OLI Collection 2 Tier 1)
  - `LANDSAT/LE07/C02/T1_L2` (ETM+ Collection 2 Tier 1)
  - `LANDSAT/LT05/C02/T1_L2` (TM Collection 2 Tier 1)
  - `LANDSAT/LT04/C02/T1_L2` (TM Collection 2 Tier 1)
  - `OSU/GIMP/2000_ICE_OCEAN_MASK` (GIMP Mask)

# GEMLST_MODIS
## Data Sources
- **MODIS Terra & Aqua**: Primary LST measurements (1km resolution)
  - Day and night observations
  - Quality control based on QC bands
- **ERA5-Land**: 
  - Surface net solar radiation (calibration)
  - Skin temperature (gap-filling)
- **GIMP Mask**: Ice/ocean masking

## Algorithm Workflow
1. **Data Preprocessing**
   - Apply quality control to MODIS data
   - Convert units to Celsius
   - Apply Greenland ice mask

2. **LST Calibration**
   - Determine data availability pattern
   - Apply calibration coefficients based on:
     - Available MODIS observations
     - Surface net solar radiation
   - Fill gaps using ERA5-Land data

3. **Output Generation**
   - Create daily composites
   - Export calibrated LST maps

## Output Description
The script [GEMLST_MODIS](GEMLST_MODIS/GEMLST_MODIS.js) generates GeoTIFF files with two bands:
1. **Corrected_LST**: Calibrated land surface temperature (Â°C)
2. **Available_Pattern**: Data source flag:
 The flag uses a binary system to represent data availability from 5 different sources:
    - Binary to Decimal Example:
    - MODIS Terra Day   = 1000 (binary) = 8 (decimal)
    - MODIS Terra Night = 0100 (binary) = 4 (decimal) 
    - MODIS Aqua Day    = 0010 (binary) = 2 (decimal)
    - MODIS Aqua Night  = 0001 (binary) = 1 (decimal)
    - ERA5-Land         = 0000 (binary) = 0 (decimal)
    
For example, a flag value of 15 indicates that all 4 MODIS data sources are available.

    | Flag Value | Binary | Available Data               |
    |------------|--------|------------------------------|
    | 15         | 1111   | All 4 MODIS data available   |
    | 8          | 1000   | Only Terra Day               |
    | 12         | 1100   | Terra Day + Terra Night      |
    | 10         | 1010   | Terra Day + Aqua Day         |
    | 0          | 0000   | No data (uses ERA5)          |

# GEMLST_Landsat
## Data Sources
- **Landsat 4-8**: Surface temperature measurements (30m resolution)
  - Thermal bands (ST_B6 for Landsat 4-7, ST_B10 for Landsat 8/9)
  - QA_PIXEL band for quality control and masking
  - QA_RADSAT band for radiometric saturation
- **GEM AWS**: Ground-based temperature measurements

## Algorithm Workflow
1. **Data Preprocessing**
* [extractLandsatLST](GEMLST_Landsat/extractLandsatLST.js)
   - Masking and filtering Landsat data
   - Convert units to Celsius
   - Extract Landsat thermal bands pixel value at AWS locations
* [awsdata_preprocessing](GEMLST_Landsat/awsdata_preprocessing.py)  
   - Extract and filter AWS data
* [lst_evaluation](GEMLST_Landsat/lst_evaluation.py)
   - Compare AWS and Landsat data
   - Determine calibration coefficients   
   
2. **Calibration Coefficients**
* [lst_calibration](GEMLST_Landsat/lst_calibration.py)
   - Determine calibration coefficients using AWS data and Landsat thermal pixel values
   - Compare original and calibrated Landsat data
   - Apply calibration coefficients to Landsat data
1. **Output Generation**
* [GEMLST_Landsat](GEMLST_Landsat/GEMLST_Landsat.js)
   - Export calibrated LST maps for Kobbefjord, Zackenberg, and Disko Island
   - Web app for extracting and visulazing LST data at any locations on Greenland

## Output Description
The output from the script [GEMLST_Landsat](GEMLST_Landsat/GEMLST_Landsat.js) is a single band raster file with calibrated LST values.
Note that the exported tiff is in Kelvin, and rescaled to uint16 (0-65535) to save storage space. 
Masked pixels are set to 0.
Users must rescales the values back by: GEMLST_Landsat_Kelvin = GEMLST_Landsat_uint16 * 0.00341802 + 149

# Comments and Future plans
- The calibration coefficients for GEMLST_MODIS needs to be updated to improve the accuracy of the product. 
- The gap filling using ERA5 data has not been validated yet. It will come in the future release. 
- The GEMLST_Landsat product replies on the existing LST product and has limited temporal resolution. We plan to generate a new LST product using the harmonized Landsat and Sentinel 2 imagery next.
  
## Author
[Andreas Westergaard-Nielsen](mailto:awn@ign.ku.dk) and [Shunan Feng](mailto:shf@ign.ku.dk).

## Last Updated
2025-02-06
